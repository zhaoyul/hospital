# AGENT INSTRUCTIONS: Backend Tests

## 1. 工具

本目录使用 `clojure.test` 编写测试用例。

## 2. 规则

- **测试覆盖:**
    - 为所有 `src/clj` 下的业务逻辑和 API 端点编写测试。
    - 尤其要关注 `web/controllers` 和 `db` 命名空间下的函数。
- **测试隔离:**
    - 测试用例应该是独立的，不应依赖于其他测试用例的执行顺序或副作用。
    - 使用 `clojure.test/use-fixtures` 来设置和清理每个测试或每个命名空间的状态（例如，重置数据库）。
- **辅助函数:**
    - 可复用的测试辅助函数（如创建模拟请求、初始化测试系统）应放在 `test/clj/hc/hospital/test_utils.clj` 中。
- **断言:**
    - 使用 `clojure.test` 提供的 `is` 宏进行断言。提供清晰的断言失败信息。
- **已知问题:**
    - `readme.org` 中已列出多个测试套件的已知失败。在着手开发前，请先熟悉这些问题。不要在未完全理解问题根源的情况下修改这些失败的测试。
